More funtions and more nested loops
